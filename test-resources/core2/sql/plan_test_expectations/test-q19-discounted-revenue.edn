[:rename
 {x50 revenue}
 [:group-by
  [{x50 (sum x49)}]
  [:map
   [{x49 (* x1 (- 1 x2))}]
   [:select
    (or
     (and
      (= x9 "Brand#12")
      x15
      (>= x4 1)
      (<= x4 (+ 1 10))
      (between x11 1 5)
      x21)
     (and
      (= x9 "Brand#23")
      x27
      (>= x4 10)
      (<= x4 (+ 10 10))
      (between x11 1 10)
      x33)
     (and
      (= x9 "Brand#34")
      x39
      (>= x4 20)
      (<= x4 (+ 20 10))
      (between x11 1 15)
      x45))
    [:apply
     :cross-join
     {x5 ?x24}
     #{x45}
     [:apply
      :cross-join
      {x10 ?x18}
      #{x39}
      [:apply
       :cross-join
       {x5 ?x24}
       #{x33}
       [:apply
        :cross-join
        {x10 ?x18}
        #{x27}
        [:apply
         :cross-join
         {x5 ?x24}
         #{x21}
         [:apply
          :cross-join
          {x10 ?x18}
          #{x15}
          [:join
           [{x3 x8}]
           [:rename
            {l_extendedprice x1,
             l_discount x2,
             l_partkey x3,
             l_quantity x4,
             l_shipmode x5,
             l_shipinstruct x6}
            [:scan
             [l_extendedprice
              l_discount
              l_partkey
              l_quantity
              l_shipmode
              {l_shipinstruct
               (= l_shipinstruct "DELIVER IN PERSON")}]]]
           [:rename
            {p_partkey x8, p_brand x9, p_container x10, p_size x11}
            [:scan [p_partkey p_brand p_container p_size]]]]
          [:top
           {:limit 1}
           [:union-all
            [:project
             [{x15 true}]
             [:select
              (= ?x18 x13)
              [:table
               [{x13 "SM CASE"}
                {x13 "SM BOX"}
                {x13 "SM PACK"}
                {x13 "SM PKG"}]]]]
            [:table [{x15 false}]]]]]
         [:top
          {:limit 1}
          [:union-all
           [:project
            [{x21 true}]
            [:select
             (= ?x24 x19)
             [:table [{x19 "AIR"} {x19 "AIR REG"}]]]]
           [:table [{x21 false}]]]]]
        [:top
         {:limit 1}
         [:union-all
          [:project
           [{x27 true}]
           [:select
            (= ?x18 x25)
            [:table
             [{x25 "MED BAG"}
              {x25 "MED BOX"}
              {x25 "MED PKG"}
              {x25 "MED PACK"}]]]]
          [:table [{x27 false}]]]]]
       [:top
        {:limit 1}
        [:union-all
         [:project
          [{x33 true}]
          [:select
           (= ?x24 x31)
           [:table [{x31 "AIR"} {x31 "AIR REG"}]]]]
         [:table [{x33 false}]]]]]
      [:top
       {:limit 1}
       [:union-all
        [:project
         [{x39 true}]
         [:select
          (= ?x18 x37)
          [:table
           [{x37 "LG CASE"}
            {x37 "LG BOX"}
            {x37 "LG PACK"}
            {x37 "LG PKG"}]]]]
        [:table [{x39 false}]]]]]
     [:top
      {:limit 1}
      [:union-all
       [:project
        [{x45 true}]
        [:select (= ?x24 x43) [:table [{x43 "AIR"} {x43 "AIR REG"}]]]]
       [:table [{x45 false}]]]]]]]]]
