[:rename
 {x50 revenue}
 [:group-by
  [{x50 (sum x49)}]
  [:map
   [{x49 (* x1 (- 1 x2))}]
   [:select
    (or
     (and
      (= x9 "Brand#12")
      x16
      (>= x4 1)
      (<= x4 (+ 1 10))
      (between x11 1 5)
      x22)
     (and
      (= x9 "Brand#23")
      x28
      (>= x4 10)
      (<= x4 (+ 10 10))
      (between x11 1 10)
      x34)
     (and
      (= x9 "Brand#34")
      x40
      (>= x4 20)
      (<= x4 (+ 20 10))
      (between x11 1 15)
      x46))
    [:group-by
     [x1
      x2
      x3
      x4
      x5
      x6
      x8
      x9
      x10
      x11
      $row_number$
      x16
      $row_number$
      x22
      $row_number$
      x28
      $row_number$
      x34
      $row_number$
      x40
      $row_number$
      {x46 (any x45)}]
     [:project
      [x1
       x2
       x3
       x4
       x5
       x6
       x8
       x9
       x10
       x11
       $row_number$
       x16
       $row_number$
       x22
       $row_number$
       x28
       $row_number$
       x34
       $row_number$
       x40
       $row_number$
       {x45 (= x5 x43)}]
      [:cross-join
       [:map
        [{$row_number$ (row-number)}]
        [:group-by
         [x1
          x2
          x3
          x4
          x5
          x6
          x8
          x9
          x10
          x11
          $row_number$
          x16
          $row_number$
          x22
          $row_number$
          x28
          $row_number$
          x34
          $row_number$
          {x40 (any x39)}]
         [:project
          [x1
           x2
           x3
           x4
           x5
           x6
           x8
           x9
           x10
           x11
           $row_number$
           x16
           $row_number$
           x22
           $row_number$
           x28
           $row_number$
           x34
           $row_number$
           {x39 (= x10 x37)}]
          [:cross-join
           [:map
            [{$row_number$ (row-number)}]
            [:group-by
             [x1
              x2
              x3
              x4
              x5
              x6
              x8
              x9
              x10
              x11
              $row_number$
              x16
              $row_number$
              x22
              $row_number$
              x28
              $row_number$
              {x34 (any x33)}]
             [:project
              [x1
               x2
               x3
               x4
               x5
               x6
               x8
               x9
               x10
               x11
               $row_number$
               x16
               $row_number$
               x22
               $row_number$
               x28
               $row_number$
               {x33 (= x5 x31)}]
              [:cross-join
               [:map
                [{$row_number$ (row-number)}]
                [:group-by
                 [x1
                  x2
                  x3
                  x4
                  x5
                  x6
                  x8
                  x9
                  x10
                  x11
                  $row_number$
                  x16
                  $row_number$
                  x22
                  $row_number$
                  {x28 (any x27)}]
                 [:project
                  [x1
                   x2
                   x3
                   x4
                   x5
                   x6
                   x8
                   x9
                   x10
                   x11
                   $row_number$
                   x16
                   $row_number$
                   x22
                   $row_number$
                   {x27 (= x10 x25)}]
                  [:cross-join
                   [:map
                    [{$row_number$ (row-number)}]
                    [:group-by
                     [x1
                      x2
                      x3
                      x4
                      x5
                      x6
                      x8
                      x9
                      x10
                      x11
                      $row_number$
                      x16
                      $row_number$
                      {x22 (any x21)}]
                     [:project
                      [x1
                       x2
                       x3
                       x4
                       x5
                       x6
                       x8
                       x9
                       x10
                       x11
                       $row_number$
                       x16
                       $row_number$
                       {x21 (= x5 x19)}]
                      [:cross-join
                       [:map
                        [{$row_number$ (row-number)}]
                        [:group-by
                         [x1
                          x2
                          x3
                          x4
                          x5
                          x6
                          x8
                          x9
                          x10
                          x11
                          $row_number$
                          {x16 (any x15)}]
                         [:project
                          [x1
                           x2
                           x3
                           x4
                           x5
                           x6
                           x8
                           x9
                           x10
                           x11
                           $row_number$
                           {x15 (= x10 x13)}]
                          [:cross-join
                           [:map
                            [{$row_number$ (row-number)}]
                            [:join
                             [{x3 x8}]
                             [:rename
                              {l_extendedprice x1,
                               l_discount x2,
                               l_partkey x3,
                               l_quantity x4,
                               l_shipmode x5,
                               l_shipinstruct x6}
                              [:scan
                               [l_extendedprice
                                l_discount
                                l_partkey
                                l_quantity
                                l_shipmode
                                {l_shipinstruct
                                 (=
                                  l_shipinstruct
                                  "DELIVER IN PERSON")}]]]
                             [:rename
                              {p_partkey x8,
                               p_brand x9,
                               p_container x10,
                               p_size x11}
                              [:scan
                               [p_partkey
                                p_brand
                                p_container
                                p_size]]]]]
                           [:table
                            [{x13 "SM CASE"}
                             {x13 "SM BOX"}
                             {x13 "SM PACK"}
                             {x13 "SM PKG"}]]]]]]
                       [:table [{x19 "AIR"} {x19 "AIR REG"}]]]]]]
                   [:table
                    [{x25 "MED BAG"}
                     {x25 "MED BOX"}
                     {x25 "MED PKG"}
                     {x25 "MED PACK"}]]]]]]
               [:table [{x31 "AIR"} {x31 "AIR REG"}]]]]]]
           [:table
            [{x37 "LG CASE"}
             {x37 "LG BOX"}
             {x37 "LG PACK"}
             {x37 "LG PKG"}]]]]]]
       [:table [{x43 "AIR"} {x43 "AIR REG"}]]]]]]]]]
