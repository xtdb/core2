[:rename
 {x1 s_name, x2 s_address}
 [:project
  [x1 x2]
  [:order-by
   [[x1 :asc :nulls-last]]
   [:semi-join
    [{x3 x9}]
    [:join
     [{x4 x6}]
     [:rename
      {s_name x1, s_address x2, s_suppkey x3, s_nationkey x4}
      [:scan [s_name s_address s_suppkey s_nationkey]]]
     [:rename
      {n_nationkey x6, n_name x7}
      [:scan [n_nationkey {n_name (= n_name "CANADA")}]]]]
    [:select
     (> x11 x25)
     [:map
      [{x25 (* 0.5 x23)}]
      [:group-by
       [x9 x10 x11 $row_number$ {x23 (sum x18)}]
       [:left-outer-join
        [{x10 x19} {x9 x20}]
        [:map
         [{$row_number$ (row-number)}]
         [:semi-join
          [{x10 x13}]
          [:rename
           {ps_suppkey x9, ps_partkey x10, ps_availqty x11}
           [:scan [ps_suppkey ps_partkey ps_availqty]]]
          [:rename
           {p_partkey x13, p_name x14}
           [:scan [p_partkey {p_name (like p_name "forest%")}]]]]]
        [:rename
         {l_quantity x18, l_partkey x19, l_suppkey x20, l_shipdate x21}
         [:scan
          [l_quantity
           l_partkey
           l_suppkey
           {l_shipdate
            (and
             (<
              l_shipdate
              (+
               #time/date "1994-01-01"
               #time/period-duration "P1Y PT0S"))
             (>= l_shipdate #time/date "1994-01-01"))}]]]]]]]]]]]
